<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>dudu55</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="dudu55">
<meta property="og:url" content="https://example.com/index.html">
<meta property="og:site_name" content="dudu55">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="duduzhang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="dudu55" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">dudu55</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-计网随意小笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/14/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2022-11-14T11:53:15.000Z" itemprop="datePublished">2022-11-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/14/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/">计网随意小笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="5-1路由器在互联网中的作用"><a href="#5-1路由器在互联网中的作用" class="headerlink" title="5.1路由器在互联网中的作用"></a>5.1路由器在互联网中的作用</h4><p>直接交付和间接交付</p>
<p><strong>交换</strong>结构：分组处理：转发表<strong>《-》</strong>路由选择处理机：路由选择协议-路由表</p>
<p><strong>明确</strong>：分组交换和路由器的关系</p>
<p>当前理解：分组交换需要用到路由表。</p>
<h3 id="转发和路由选择的区别："><a href="#转发和路由选择的区别：" class="headerlink" title="转发和路由选择的区别："></a><strong>转发和路由选择的区别：</strong></h3><p><strong>转发(forwarding)<strong>：就是</strong>路由器</strong>根据转发表将用户的IP数据报从合适的端口转发出去。</p>
<p>区分：端口，交换机，路由器</p>
<p>**路由选择(routing)**：按照分布式算法，根据从各相邻路由器得到的关于网络拓扑的变化情况，动态地改变所选择的路由。</p>
<p>路由表是根据路由选择算法得出的，而转发表是根据路由表得出的。</p>
<p>路由表</p>
<table>
<thead>
<tr>
<th>目的网络</th>
<th>下一跳地址</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>这个是啥来着，复习到后面自己补充</p>
<table>
<thead>
<tr>
<th>网络号</th>
<th>距离</th>
<th>直接交互&#x2F;下一个</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<img src="计网随意小笔记/1.png" alt="1" style="zoom:50%;" />

<p>交换结构？</p>
<p>上面的图片是从下往上，送到网络层之后，路由器要处理分组，？</p>
<p>下面的图片是从上（交换结构）往下</p>
<h4 id="5-2网络层提供的服务"><a href="#5-2网络层提供的服务" class="headerlink" title="5.2网络层提供的服务"></a>5.2网络层提供的服务</h4><p>数据链路层的任务：在相邻的两个节点之间实现数据帧的透明传输。</p>
<p>网络层的任务：负责将分组从源节点传送到目的节点。</p>
<p>局域网中的网络层功能很弱：</p>
<p><strong>在单个局域网中，网络层并不重要</strong></p>
<p>网络层主要实现的是<strong>局域网的互联</strong></p>
<p><strong>服务的可靠和连接的关系？</strong></p>
<p>可靠：指的是数据没有丢失、损坏或重复；</p>
<p>是采用应答来实现，即<strong>可靠&#x2F;不可靠</strong>可以用<strong>有&#x2F;无应答</strong>来区分</p>
<p>面向连接：本质是保证数据的顺序传送</p>
<p>特征是数据传送必须经过建立连接、传送数据和拆除连接三个阶段。</p>
<p>它俩没有关系！</p>
<h4 id="IP地址编制方法"><a href="#IP地址编制方法" class="headerlink" title="IP地址编制方法"></a>IP地址编制方法</h4><p>网际协议IP是TCP&#x2F;IP体系中两个最主要的协议之一。与IP协议配套使用的还有四个协议：</p>
<p>ARP: Address Resolution Protocol 地址解析协议</p>
<p>RARP: Reverse Address Resolution Protocol</p>
<p>ICMP: Internet Control Message Protocol 因特网控制报文协议</p>
<img src="计网随意小笔记/2.png" alt="2" style="zoom:50%;" />

<h4 id="IP地址编址的三个阶段"><a href="#IP地址编址的三个阶段" class="headerlink" title="IP地址编址的三个阶段"></a>IP地址编址的三个阶段</h4><p>IP地址编址的三个阶段</p>
<h4 id="分类的IP地址"><a href="#分类的IP地址" class="headerlink" title="分类的IP地址"></a><u><strong>分类的IP地址</strong></u></h4><p>每一类地址由<strong>两个</strong>固定长度的字段组成</p>
<p>其中一个字段是网络号，标志主机（或路由器）连接到的网络</p>
<p>另一个字段是主机号，标志该主机（或路由器）</p>
<img src="计网随意小笔记/3.png" alt="3" style="zoom:40%;" />

<p>A类地址的网络号字段为1字节（8bit 8位）</p>
<p><strong>A类 1-126</strong> </p>
<p>2的7次方 - 2</p>
<p>0111 1111 是127（不能用？）127开头的网络号是用作本地软件进行回环测试用</p>
<p><strong>B类从128开始</strong></p>
<p><strong>C类从192开始</strong></p>
<h5 id="路由器转发分组的步骤"><a href="#路由器转发分组的步骤" class="headerlink" title="路由器转发分组的步骤"></a>路由器转发分组的步骤</h5><p>先按所要找的IP地址中的网络号net-id把目的网路找到</p>
<p>当分组到达目的网络后，利用主机号host-id将数据包直接交付给目的主机</p>
<p><strong>一般不使用的特殊IP地址</strong></p>
<table>
<thead>
<tr>
<th>网络号</th>
<th>主机号</th>
<th>源地址</th>
<th>目的地址</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>可以</td>
<td>不可以</td>
<td>在本网络上的本主机</td>
</tr>
<tr>
<td>0</td>
<td>host-id</td>
<td>可以</td>
<td>不可以</td>
<td>在本网络上的某个主机</td>
</tr>
<tr>
<td>全1</td>
<td>全1</td>
<td>不可以</td>
<td>可以</td>
<td>只在本网络上进行广播（对各路由器均不转发）</td>
</tr>
<tr>
<td>net-id</td>
<td>全1</td>
<td>不可以</td>
<td>可以</td>
<td>对net-id上所有主机进行广播</td>
</tr>
<tr>
<td>127</td>
<td>任何数</td>
<td>可以</td>
<td>可以</td>
<td>用作本地软件进行环回测试用</td>
</tr>
</tbody></table>
<p>IP地址管理机构在分配IP地址时只分配网络号，剩下的主机号由得到该网络号的单位自行分配，方便IP地址的管理。</p>
<p>路由器仅根据目的主机所连接的网络号来转发分组（不考虑目的主机号），可以使得路由表中的项目数大幅度减少，减小了路由表所占的存储空间。</p>
<p>IP地址是标识“一个主机（或路由器）和一条链路的接口。当一个主机同时连接到两个网络的时候，该主机就必须同时具有两个相应的IP地址，网络号net-id必须是不同的。</p>
<p>因此：一个路由器至少应该有两个不同的IP地址。</p>
<p>局域网内只有交换机</p>
<p>局域网之间才有路由器，对</p>
<p>以太网是一种局域网技术，使用交换机连接不同设备。</p>
<p>以太网的标准拓扑结构为总线型拓扑，但快速以太网（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/100BASE-T?fromModule=lemma_inlink">100BASE-T</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/1000BASE-T?fromModule=lemma_inlink">1000BASE-T</a>标准）为了减少冲突，将能提高的网络速度和使用效率最大化，使用交换机来进行网络连接和组织。如此一来，以太网的拓扑结构就成了<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%98%9F%E5%9E%8B?fromModule=lemma_inlink">星型</a>；但在逻辑上，以太网仍然使用总线型拓扑和<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/CSMA%2FCD?fromModule=lemma_inlink">CSMA&#x2F;CD</a>（Carrier Sense Multiple Access&#x2F;Collision Detection，即载波多重访问&#x2F;碰撞侦测）的总线技术。</p>
<p><strong>局域网内部是交换机</strong> 交换机是特殊的网桥，</p>
<h4 id="用转发器或网桥连接起来的若干个局域网仍为一个网络，这些局域网都有具有同样的net-id。"><a href="#用转发器或网桥连接起来的若干个局域网仍为一个网络，这些局域网都有具有同样的net-id。" class="headerlink" title="用转发器或网桥连接起来的若干个局域网仍为一个网络，这些局域网都有具有同样的net-id。"></a>用转发器或网桥连接起来的若干个局域网仍为一个网络，这些局域网都有具有同样的net-id。</h4><h4 id="也就是说：局域网之间可以用转发器连接，网桥连接，那这还是一个局域网，比如下图中的-B-。"><a href="#也就是说：局域网之间可以用转发器连接，网桥连接，那这还是一个局域网，比如下图中的-B-。" class="headerlink" title="也就是说：局域网之间可以用转发器连接，网桥连接，那这还是一个局域网，比如下图中的**B**。"></a><strong>也就是说：</strong>局域网之间可以用转发器连接，网桥连接，那这还是一个局域网，比如下图中的**<u>B</u>**。</h4><p>或者路由器连接。</p>
<p>网络和网络之间是路由器</p>
<h5 id="这里还可以再回顾一下前面第一章的内容：基础知识，能否有更加深入的理解。"><a href="#这里还可以再回顾一下前面第一章的内容：基础知识，能否有更加深入的理解。" class="headerlink" title="这里还可以再回顾一下前面第一章的内容：基础知识，能否有更加深入的理解。"></a>这里还可以再回顾一下前面第一章的内容：基础知识，能否有更加深入的理解。</h5><p>仅是局域网内部访问，根本不需要路由器，只要交换机即可。</p>
<h4 id="在同一个局域网上的主机或路由器的IP地址中的网络号必须是一样的"><a href="#在同一个局域网上的主机或路由器的IP地址中的网络号必须是一样的" class="headerlink" title="在同一个局域网上的主机或路由器的IP地址中的网络号必须是一样的"></a>在<strong>同一个局域网上</strong>的主机或路由器的IP地址中的<strong>网络号</strong>必须是一样的</h4><img src="计网随意小笔记/4.png" alt="4" style="zoom:50%;" />

<img src="D:\note\5.png" alt="5" style="zoom:50%;" />

<p>总结一下这几句话：</p>
<p>1.用转发器或网桥连接起来的若干个局域网仍为一个网络，因此这些局域网都具有同样的网络号</p>
<p>2.同一个局域网的主机的ip地址的网络号必须是一样的</p>
<h4 id="子网的划分："><a href="#子网的划分：" class="headerlink" title="子网的划分："></a><u>子网的划分：</u></h4><p>子网的划分纯属一个单位内部的事情。</p>
<p>从主机号借用若干个比特作为子网号，因此host-id相应减少了若干个比特</p>
<p>下图是B类地址，前两位要一样，属于同一网络。</p>
<img src="计网随意小笔记/16.png" alt="16" style="zoom:67%;" />



<p>子网掩码</p>
<p>从一个IP数据包的首部无法判断源主机或目的主机所连接的网络是否进行了子网划分</p>
<p>使用子网掩码可以很方便地找出IP地址中的子网部分</p>
<img src="计网随意小笔记/17.png" alt="17" style="zoom:50%;" />

<img src="D:\note\18.png" alt="18" style="zoom:50%;" />

<p>子网掩码不一定</p>
<p>IP地址与子网掩码做AND运算，观察结果是否为网络地址</p>
<p>IP地址逐一和子网掩码作运算，看和网络地址是否对应</p>
<p>子网掩码是判断IP地址属于哪个子网（路由表记录目的网络地址和子网掩码）</p>
<img src="计网随意小笔记/19.png" alt="19" style="zoom:50%;" />

<p>非Internet连接的网络地址：</p>
<p>LAN 局域网 子网</p>
<p>例题：</p>
<p>解：</p>
<p>子网部分也不用全0或全1</p>
<p>LAN1</p>
<p>01 00 0001 - 01 00 1110</p>
<p>LAN2</p>
<p>10 00 0001 - 10 11 1110</p>
<p>子网掩码：</p>
<p>11 00 0000</p>
<p>网络号：01 00 0000， 10 00 0000</p>
<p>一个网络地址可分配的最大主机数是：</p>
<p>2的n次方-2（n是主机部分的位数）</p>
<p><strong>全0地址表示本网络，全1地址表示广播地址</strong></p>
<p>非标准子网掩码：</p>
<p>1111 1111 255</p>
<p>001，010，011,100,101,110</p>
<p>1110 0000 掩码 </p>
<p>0000 0000</p>
<h4 id="构成超网：无分类编址方法"><a href="#构成超网：无分类编址方法" class="headerlink" title="构成超网：无分类编址方法"></a><u>构成超网：无分类编址方法</u></h4><h4 id="无分类编址CIDR"><a href="#无分类编址CIDR" class="headerlink" title="无分类编址CIDR"></a>无分类编址CIDR</h4><p>Classless Inter-Domain Routing 无分类域间路由选择</p>
<p>e.g</p>
<p>128.14.32.0&#x2F;20</p>
<p>表示前20位是网络号，后12位是主机号</p>
<p>10000000 00001110 0010       0000 00000000</p>
<p>10000000 00001110 0010       1111 11111111</p>
<p>路由聚合：</p>
<p>一个CIDR地址块可以表示很多地址，这种地址的聚合成为路由聚合。</p>
<p>路由聚合也称为<strong>构成超网（super netting)</strong></p>
<p>仍然使用<strong>掩码</strong>这一名词</p>
<p>对于&#x2F;20地址块，前20保持不变，则掩码就是20个连续的1，可以说，斜杠后面的数就是掩码中1的个数。</p>
<p><strong>IP</strong>和<strong>掩码</strong>做<strong>与运算</strong> 得到最长前缀</p>
<p>如果两个都匹配，选择最长前缀的地址，最长前缀匹配</p>
<img src="计网随意小笔记/20.png" alt="20" style="zoom:50%;" />

<p>二叉线索中的各个路径就代表路由表中存放的各个地址。</p>
<p>IP数据报格式：</p>
<p>IP数据包是干啥？是要传送消息，然后一层一层往下，剥开</p>
<p>一个IP数据包由由首部和数据两部分组成。</p>
<img src="计网随意小笔记/6.png" alt="6" style="zoom:45%;" />

<p>IP首部长度的最大值是60字节。首部固定部分是固定长度20字节，可变部分长度是可变的。</p>
<p>服务类型规定对本数据报的处理方式。</p>
<p>总长度表示首部和数据之和的长度，单位为字节。因此数据报的最大长度为2的16次方减1个字节，</p>
<img src="计网随意小笔记/7.png" alt="7" style="zoom:80%;" />

<p>也就是说，切8字节的倍数？</p>
<img src="计网随意小笔记/8.png" alt="8" style="zoom:50%;" />

<p>协议字段指出此数据报携带的数据使用何种协议（如TCP&#x2F;UDP）</p>
<p>以便<strong>目的主机的IP层将数据部分上交给哪个处理过程</strong></p>
<img src="计网随意小笔记/9.png" alt="9" style="zoom:50%;" />

<p>首部检验和字段只检验数据报的首部，不包括数据部分，这里不采用CRC检验码而是采用简单的算术计算方法。</p>
<img src="计网随意小笔记/10.png" alt="10" style="zoom:67%;" />

<p>这是怎么个事儿，如下，加一起</p>
<img src="计网随意小笔记/11.png" alt="11" style="zoom:90%;" />

<img src="计网随意小笔记/12.png" alt="12" style="zoom:50%;" />

<img src="计网随意小笔记/13.png" alt="13" style="zoom:50%;" />

<h4 id="分组转发算法："><a href="#分组转发算法：" class="headerlink" title="分组转发算法："></a>分组转发算法：</h4><p>1.从数据包的首部提取目的站的IP地址D，得出目的网络地址为N</p>
<p>2.若网络N与此路由器直接连接，则直接将数据包交付给目的站D，否则是间接交付，执行（3）</p>
<p>3.若路由表中有目的地址为D的特定主机路由，则将数据报传送给路由表中所指明的下一跳路由器；否则，执行4.</p>
<p>4.若路由表中有到达网络N的路由，则将数据报传送给路由表指明的下一跳路由器；否则，执行5</p>
<p>5.若路由表中有一个默认路由，则将数据报传送给路由表中所指明的默认路由器；否则，执行6</p>
<p>6.报告转发分组出错</p>
<p>实际中路由器如何转发分组：</p>
<p>当路由器收到待转发的数据报，送交下层的网络接口软件。</p>
<p>网络接口软件使用ARP负责将下一条路由器的IP地址转换成硬件地址，并将此硬件地址放在链路层的MAC帧的首部，然后根据这个硬件地址找到下一跳路由器。</p>
<img src="计网随意小笔记/14.png" alt="14" style="zoom:70%;" />

<img src="计网随意小笔记/15.png" alt="14" style="zoom:70%;" />



<p>区分路由协议和网络层协议：</p>
<p>网络层协议是能写到IP报文首部的协议中，指明是什么协议：ARP?ICMP?之类的</p>
<h3 id="路由协议"><a href="#路由协议" class="headerlink" title="路由协议"></a>路由协议</h3><p>内部网关协议：RIP，OSPF</p>
<p>外部网关协议：BGP</p>
<p>自治系统（autonomous system）：</p>
<p>大型网络如因特网，会被分解成多个自治系统</p>
<p>一个自治系统内的所有网络都属于一个行政单位（例如 一个公司 一所大学</p>
<p>一个自治系统， 其最重要的特点就是自治系统有权自主地决定在本系统内应采用何种路由选择协议。<br>一个自治系统的所有路由器在本自治系统内都必须是连通的。</p>
<p> 因特网有两大类<strong>路由选择协议</strong>：</p>
<p>内部网关协议IGP Interior Gateway Protocol，即在一个自治系统内部使用的路由选择协议</p>
<p>外部网关协议EGP External Gateway Protocol 在自治系统之间的</p>
<img src="计网随意小笔记/21.png" alt="21" style="zoom:67%;" />

<p>RIP Routing Information Protocol</p>
<p>是一种分布式的基于距离向量的路由选择协议</p>
<p>RIP允许一条路径最多只能包含15个路由器，16相当于不可达。</p>
<p>就选择最短的，哪怕还存在另一条高速（低时延）但路由器较多的路由。</p>
<p>每一个路由器需要不断地与其他路由器交换路由信息。</p>
<p>一开始各路由表只有相邻路由器的信息</p>
<p>经过若干次更新后，所有的路由器最终都会知道到达本自治系统中任何一个网络的最短距离和下一条路由器的地址。</p>
<p>RIP协议的收敛（convergence）过程较快</p>
<p><strong>收到相邻路由器（其地址为X）的一个RIP报文：</strong></p>
<p>先修改这个RIP报文，把下一条地址都改为<strong>X</strong>，并将所有距离都加一</p>
<p>若项目中的网络不在我这，则加进来</p>
<p>若在，如果下一条路由器是一样的，则更新</p>
<p>​           如果下一条路由器是不一样的，如果距离笑了，更新，否则啥也不干（路由器不一样，距离还大，不更新）</p>
<p>好消息传的快，坏消息传的慢</p>
<p>OSPF Open Shortest Path First</p>
<p>开放式最短路径优先</p>
<p>是分布式的链路状态协议</p>
<p>RIP是距离向量协议</p>
<p>抽象为求图中一对顶点间的最短通路</p>
<p>详细的说：</p>
<p>首先从起始点出发，找出距起始点最短的通路</p>
<p>然后在此基础上找出距起始点次短的通路，如此反复，每次都找出比前一次次短的通路，直到某个通路达到某个目的地。</p>
<p>通过各个节点之间的路由信息交换，每个节点可以获得全网的拓扑信息（包括：网中所有的节点，各个节点之间的链路连接以及各条链路的代价）。</p>
<p>链路状态路由选择算法的组成：</p>
<p>1.找邻居节点</p>
<p>每一个节点启动后，首先在所有与之相连的点点线路上发送询问分组，线路上另一端的节点收到后给以回应，告知其网络地址。</p>
<p>启动后，向所有邻节点发出HELLO分组，工作台的路由器收到后发送应答告知地址。</p>
<p>2.确定链路代价</p>
<p>每个节点确定与之相连的每条链路的代价。</p>
<p>发送ECHO分组，要求对方立即响应，测得来回时间除以2.若想要更精确可以多测几次，取平均值</p>
<p>为了动态获得链路状态，每10分钟测一次，取得延时。</p>
<p>3.构造并发布链路状态分组</p>
<p>各节点测得延时后，构造状态分组，并向邻节点发布。各路由器根据得到的邻节点送来的最新状态分组，计算新路由。</p>
<p>4.地杰斯特拉计算最短路径</p>
<img src="计网随意小笔记/22.png" alt="22" style="zoom:50%;" />

<p>RIP仅向自己相邻的路由器发送信息，但是包含了和已知的各个路由器的连接信息（到所有网络的距离以及下一条路由器）</p>
<p>OSPF向本自治系统中所有路由器发送信息，发送的信息是与本路由器相邻的所有路由器的链路状态。</p>
<p>只有当链路状态发生变化时，路由器才用洪泛法向所有路由器发送此消息</p>
<p>RIP定期发送</p>
<p>OSPF的区域（将一个自治系统再划分为若干个更小的范围）</p>
<img src="计网随意小笔记/23.png" alt="23" style="zoom:50%;" />

<p>OSPF是直接用IP数据包传送，IP数据报首部的协议字段值是89</p>
<img src="计网随意小笔记/24.png" alt="24" style="zoom:50%;" />

<img src="计网随意小笔记/25.png" alt="25" style="zoom:50%;" />

<img src="计网随意小笔记/28.png" alt="28" style="zoom:67%;" />

<img src="计网随意小笔记/26.png" alt="26" style="zoom:50%;" />

<p>外部网关协议BGP</p>
<p>每一个自治系统的管理员要选择至少一个路由器作为该自治系统的“BGP发言人”</p>
<p>一般来说，两个BGP发言人都是通过一个共享网络连接在一起，而BGP发言人往往就是BGP边界路由器，但也可以不是BGP边界路由器。</p>
<p>一个 BGP 发言人与其他自治系统中的 BGP 发言人要交换路由信息，就要先建立 TCP 连接，<br>然后在此连接上交换 BGP 报文以建立 BGP 会话(session)，利用 BGP 会话交换路由信息。  </p>
<img src="计网随意小笔记/27.png" alt="27" style="zoom:60%;" />



<p>传输层</p>
<p>UDP</p>
<p>端口的概念：</p>
<p>端口就是运输层服务访问点TSAP</p>
<p>端口的作用就是让应用层各种应用进程都能将其数据通过端口向下交付给运输层。</p>
<p>以及能让运输层知道应道将其报文段中的数据向上通过端口交付给应用层相应的进程。</p>
<p><strong>端口是用来标志应用层的进程。</strong></p>
<p>每个进程对应一个端口</p>
<p>协议字段：TCP是</p>
<img src="计网随意小笔记/9.png" alt="9" style="zoom:67%;" />

<p><img src="/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/35.png" alt="35"></p>
<p>进程之间的通信：</p>
<p>IP分用：<strong>TCP是6，UDP是17</strong></p>
<p>运输层的分用依靠不同的端口，将其上交给不同的应用进程</p>
<p>端口用一个16位2的16次方，也就是2^6*2的10次方</p>
<p>16位，每位0&#x2F;1，那么有2的16次方种情况：</p>
<p>一共是加一起是2^16-1，加上00000000000的情况</p>
<p>1K是2的10次方</p>
<p>1M是2的20次方</p>
<p>1G是2的30次方</p>
<p>端口号只具有本地意义</p>
<p><strong>两类端口</strong></p>
<img src="计网随意小笔记/36.png" alt="36" style="zoom:67%;" />

<img src="D:\note\37.png" alt="37" style="zoom: 67%;" />

<img src="计网随意小笔记/38.png" alt="38" style="zoom:67%;" />

<p>服务端口号：登记端口号：1024-49151</p>
<p>客户端口号：49152-65535</p>
<p>UDP：只在IP的数据报服务之上增加了很少一点的功能，也就是<strong>端口的功能和差错检测的功能。</strong></p>
<p>网络出现的拥塞不会使源主机的发送速率降低，这对某些实时应用很重要</p>
<p>UDP只提供不可靠的交付</p>
<h3 id="TCP可靠传输的实现"><a href="#TCP可靠传输的实现" class="headerlink" title="TCP可靠传输的实现"></a>TCP可靠传输的实现</h3><p>TCP是面向流的</p>
<p>TCP对应用进程一次把多长的报文发送到TCP的缓存中是不关心的</p>
<p>TCP根据对方给出的窗口值和当前网络的拥塞程序来决定一个报文段应包含多少个字节（UDP发送的报文长度是应用进程给出的）。</p>
<p>TCP可以把太长的数据块划分短一些再发送，或者基类足够多的字节后再构成报文段发送出去。</p>
<p>TCP报文段（segment）</p>
<img src="计网随意小笔记/39.png" alt="39" style="zoom:70%;" />

<p>序号字段指本报文段所发送数据的第一个字节的序号：<br>e.g 若序号字段值为301，携带数据共100字节；则本报文段数据的第一个字节的序号为301，最后一个字节的序号为400，那么下一个报文段的序号字段为401</p>
<p>数据偏移：就是首部长度，指TCP报文段的数据起始处距离TCP报文段的起始处有多远。</p>
<p><strong>数据偏移的单位是32位（以4字节为计算单位</strong></p>
<p><strong>SYN&#x3D;1表示这是一个连接请求或者连接接受报文</strong></p>
<p>FIN&#x3D;1表示此报文段的发送端的数据已经发送完毕，并要求释放运输连接</p>
<p>窗口字段，用来<strong>控制对方发送的数据量</strong>，单位为字节，</p>
<p>TCP连接的一端根据设置的缓存空间大小确定自己接收窗口的大小，然后通知对方以确定对方的发sing窗口的上限。</p>
<p><strong>设一个报文段确认号是701，窗口字段是1000</strong></p>
<p>含义：从701号算起，发送此报文段的一方还有接受1000个字节数据的接收缓存空间（701-1700）</p>
<p>窗口字段指明了<strong>现在允许对方发送的数据量</strong>（窗口值是接收方让发送方设置其发送窗口的依据），是动态变化的</p>
<p>MSS 最大报文段长度</p>
<p>其它选项（稍微了解）：</p>
<p>窗口扩大选项 时间戳 选择确认</p>
<p><strong>TCP报文结构</strong></p>
<p>IP和端口的组合 套接字socket</p>
<p>套接字&#x3D;（IP地址：端口号）</p>
<p>TCP连接的端点：套接字</p>
<p>TCP连接的建立和释放：</p>
<p>连接建立，数据传送、连接释放</p>
<p>知道对方存在 协商参数 资源</p>
<p>TCP连接的建立都是采用客户服务器的方式（CS client server</p>
<p>主动发起连接的应用进程是客户，被动等待建立是服务器</p>
<p>三次握手：</p>
<p>开始都是close</p>
<p>第一步：客户主动打开，服务器被动打开，</p>
<p>A的TCP向B发出连接请求报文段，SYN（标志位）&#x3D;1，并选择序号seq &#x3D; x，表明传送数据时的第一个数据字节的序号是x，</p>
<p>窗口大小 标志位 序号 确认号 一定掌握</p>
<p>第二个报文：</p>
<p>SYN请求和请求的确认</p>
<p>SYN &#x3D; 1，[ACK &#x3D; 1，确认号ack &#x3D; x+1]，自己选择的序号seq &#x3D; y。</p>
<p>第三个报文：（确认的确认）</p>
<p>[ACK &#x3D; 1（是确认报文），ack &#x3D; y+1]，<strong>seq &#x3D; x+1；</strong>seq号和方向有关</p>
<img src="计网随意小笔记/29.png" alt="29" style="zoom:67%;" />

<p>TCP连接释放：对称释放</p>
<p>A-&gt;B FIN  &#x3D; 1 seq &#x3D; u</p>
<p>B-&gt;A ACK &#x3D; 1, ack &#x3D; u+1 seq &#x3D; v</p>
<p>A到B关了 B到A还是通的</p>
<p>B-&gt;A FIN &#x3D; 1 <strong>ACK&#x3D;1 ack&#x3D;u+1</strong>（为啥？？？？） seq &#x3D; w &#x3D;f(v)(传送多少数据是能算出来的)</p>
<p>A-&gt;B ACK&#x3D;1，seq &#x3D; u+1 ack&#x3D;w+1</p>
<img src="计网随意小笔记/30.png" alt="30" style="zoom:50%;" />







<p>完全理想化的数据传输</p>
<p>假定1：传输信道不产生差错</p>
<p>出差错怎么办：重发，隔多长时间重发呢？</p>
<p>假定2：不管发送方多快发送数据，接收方总是来得及处理收到的数据。</p>
<p>接收方来不及处理怎么办？</p>
<p>发慢一点 流量控制</p>
<p><strong>停止等待协议</strong></p>
<p>每发送完 一个分组就停止发送，等待对方的确认，收到确认后发送下一个分组</p>
<p><strong>发送时延，传播时延，处理时延</strong>  发送时延在图中则么看？？？？</p>
<p>停止等待协议的信道利用率</p>
<p><img src="/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/40.png" alt="40"></p>
<p>在发送完一个分组后，必须暂时保留已发送分组的副本</p>
<p>如果数据帧被正确接收，而应答帧丢失和延迟到达，这样发送方在定时内没收到应答帧，重发该镇，导致帧重复。</p>
<p>识别帧重复：<br>分组和确认分组都必须进行编号：</p>
<p>明确哪个分组收到了确认，哪个没收到</p>
<p>ARQ自动重传请求</p>
<p><strong>连续ARQ协议</strong></p>
<p>发送端：</p>
<p>接收端：只按序接收分组</p>
<p>累积确认：不必对收到的分组逐个发送确认，对按序到达的最后一个分组发送确认</p>
<p>回退N 某一个帧出错了 从它开始重传</p>
<p>超时以后才重发 没超时不重发 继续发</p>
<p><strong>发送窗口的最大值：</strong></p>
<p><strong>当用n个比特 （2的n次方）-1</strong></p>
<p>当采用3Bit编码，发送窗口最大值是7，</p>
<p>选择重传的ARQ协议：</p>
<p><strong>接收窗口的尺寸</strong></p>
<p><strong>2的（n-1）次方</strong>，也就是序号范围的1&#x2F;2</p>
<p>停止等待协议</p>
<p>TD&#x2F;TD+TA+RTT</p>
<p>连续发送n个帧，连续ARQ</p>
<p>信道利用率：nTD&#x2F;TD+TA+RTT</p>
<p>小窗口ARQ nTD&lt;TD+RTT+TA</p>
<p>大窗口ARQ nTD&gt;&#x3D;TD+RTT+TA  信道利用率为1</p>
<img src="计网随意小笔记/32.png" alt="32" style="zoom:50%;" />

<h3 id="滑动窗口协议："><a href="#滑动窗口协议：" class="headerlink" title="滑动窗口协议："></a>滑动窗口协议：</h3><p><strong>是停等协议和连续ARQ协议的折中</strong></p>
<img src="计网随意小笔记/33.png" alt="33" style="zoom:50%;" />

<p>确认号是B期望收到的序列号</p>
<img src="计网随意小笔记/41.png" alt="41" style="zoom:50%;" />

<img src="D:\note\42.png" alt="42" style="zoom:50%;" />



<img src="计网随意小笔记/43.png" alt="43" style="zoom:50%;" />



<img src="计网随意小笔记/44.png" alt="44" style="zoom:50%;" />






























      
    </div>
    <footer class="article-footer">
      <a data-url="https://example.com/2022/11/14/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/" data-id="clagqogmx0001g0ua44khe4qj" data-title="计网随意小笔记" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82%E3%80%81%E4%BC%A0%E8%BE%93%E5%B1%82/" rel="tag">网络层、传输层</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-My-first-blog-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/14/My-first-blog-1/" class="article-date">
  <time class="dt-published" datetime="2022-11-14T11:52:18.000Z" itemprop="datePublished">2022-11-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/14/My-first-blog-1/">My first blog</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>My first blog is established. </p>
<p>Since the last year, I have the idea. </p>
<p>But that time I was stupid with little professional knowledge. </p>
<p>So this time, I come back. 55</p>
<p>2022&#x2F;11&#x2F;14 </p>
<p>duduzhang</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://example.com/2022/11/14/My-first-blog-1/" data-id="clagqogms0000g0ua5kf63ooc" data-title="My first blog" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82%E3%80%81%E4%BC%A0%E8%BE%93%E5%B1%82/" rel="tag">网络层、传输层</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82%E3%80%81%E4%BC%A0%E8%BE%93%E5%B1%82/" style="font-size: 10px;">网络层、传输层</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/14/%E8%AE%A1%E7%BD%91%E9%9A%8F%E6%84%8F%E5%B0%8F%E7%AC%94%E8%AE%B0/">计网随意小笔记</a>
          </li>
        
          <li>
            <a href="/2022/11/14/My-first-blog-1/">My first blog</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 duduzhang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>